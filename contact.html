<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Contact - Prince CPAs & Advisors</title>
  <link rel="stylesheet" href="styles.css" />
  
</head>
<body>
  <header>
    <h1>Prince CPAs & Advisors</h1>
  </header>

  <nav>
    <a href="index.html">Home</a>
    <a href="about.html">About Us</a>
    <a href="services.html">Services</a>
    <a href="contact.html">Contact</a>
  </nav>

  <!-- HERO -->
  <section class="hero" aria-label="Contact Prince CPAs & Advisors">
    <div class="hero-panel">
      <h2>Contact Us</h2>
      <p>Send a message and we’ll get back to you promptly.</p>
    </div>
  </section>

  <!-- CONTACT FORM -->
  <section class="section" aria-labelledby="contact-heading">
    <h3 id="contact-heading"><span>Send a Message</span></h3>

    <form id="contact-form" novalidate>
      <!-- Hidden spam-trap field (bots fill it; humans never see it) -->
      <input
        type="text"
        name="company"
        id="company"
        autocomplete="off"
        style="position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden;"
        tabindex="-1"
        aria-hidden="true"
      >

      <div class="row">
        <div>
          <label for="name">Name <span class="visually-hidden">(required)</span></label>
          <input type="text" id="name" name="name" autocomplete="name" required />
          <div class="error" id="err-name" aria-live="polite"></div>
        </div>

        <div>
          <label for="email">Email <span class="visually-hidden">(required)</span></label>
          <input type="email" id="email" name="email" autocomplete="email" required />
          <div class="error" id="err-email" aria-live="polite"></div>
        </div>
      </div>

      <div>
        <label for="message">Message <span class="visually-hidden">(required)</span></label>
        <textarea id="message" name="message" rows="6" required></textarea>
        <div class="help">Include deadlines or specifics (e.g., year-end, services needed).</div>
        <div class="error" id="err-message" aria-live="polite"></div>
      </div>

      <button type="submit" id="submit-btn">Send Message</button>
      <div class="status" id="status" role="status" aria-live="polite"></div>
    </form>
  </section>

  <footer>
    <p>&copy; 2026 Prince CPAs & Advisors. All rights reserved.</p>
  </footer>

  <script>
    (function(){
      // IMPORTANT:
      // You must use the Apps Script *Web App* URL that ends in /exec
      // Example: https://script.google.com/macros/s/XXXXX/exec
      const ENDPOINT = "PASTE_YOUR_WEB_APP_EXEC_URL_HERE";

      const form = document.getElementById('contact-form');
      const btn = document.getElementById('submit-btn');
      const statusEl = document.getElementById('status');

      const errName = document.getElementById('err-name');
      const errEmail = document.getElementById('err-email');
      const errMsg = document.getElementById('err-message');

      function setStatus(kind, msg){
        statusEl.className = "status " + (kind || "");
        statusEl.textContent = msg || "";
        statusEl.style.display = msg ? "block" : "none";
      }

      function clearErrors(){
        errName.textContent = "";
        errEmail.textContent = "";
        errMsg.textContent = "";
        setStatus("", "");
      }

      function isValidEmail(email){
        return /^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email);
      }

      form.addEventListener('submit', async function(e){
        e.preventDefault();
        clearErrors();

        const name = document.getElementById('name').value.trim();
        const email = document.getElementById('email').value.trim();
        const message = document.getElementById('message').value.trim();
        const company = document.getElementById('company').value.trim(); // spam trap

        let ok = true;
        if(!name){ errName.textContent = "Please enter your name."; ok = false; }
        if(!email || !isValidEmail(email)){ errEmail.textContent = "Enter a valid email."; ok = false; }
        if(!message){ errMsg.textContent = "Please add a brief message."; ok = false; }

        if(!ok) return;

        // If endpoint isn't set, fail loudly (common mistake)
        if(!ENDPOINT || ENDPOINT.includes("https://script.google.com/macros/s/AKfycbxUoo9Gn5JWr3pCKOt12iIC7Km-KJBDNs2-eKywn23ou8tNocT_R1qga2fH_CPH0RwG3w/exec")){
          setStatus("bad", "Form is not configured yet: paste your Apps Script Web App /exec URL into ENDPOINT.");
          return;
        }

        btn.disabled = true;
        const oldText = btn.textContent;
        btn.textContent = "Sending...";

        try {
          const payload = {
            name,
            email,
            message,
            company, // bots fill this; humans don't
            page: window.location.href,
            userAgent: navigator.userAgent
          };

          const res = await fetch(ENDPOINT, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload)
          });

          // Apps Script sometimes returns 200 even on errors; rely on JSON ok flag too.
          const out = await res.json().catch(() => ({}));

          if (!res.ok || out.ok !== true) {
            throw new Error(out.error || "Submission failed.");
          }

          form.reset();
          setStatus("ok", "Message sent. We’ll get back to you promptly.");
        } catch (err) {
          console.error(err);
          setStatus("bad", "Sorry — something went wrong sending your message. Please try again.");
        } finally {
          btn.disabled = false;
          btn.textContent = oldText;
        }
      });
    })();
  </script>
</body>
</html>
